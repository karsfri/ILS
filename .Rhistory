dev.args=list(bg="white")
)
df <- yfirverd()
traceback()
source('~/GitHub/ILS/theme_hms.R', encoding = 'UTF-8')
# set template
source("https://github.com/karsfri/ILS/raw/master/theme_hms.R")
source("https://github.com/karsfri/ILS/raw/master/demo_automation.R", encoding = "UTF-8")
theme_set_hms()
library(tidyverse)
# √ûannig a√∞ m√°na√∞arn√∂fnin koma r√©tt
Sys.setenv(LANGUAGE="is")
Sys.setlocale("LC_TIME", "Icelandic")
knitr::opts_chunk$set(
echo = TRUE,
fig.width = 18/2.54,
message = FALSE,
warning = FALSE,
include = TRUE,
dpi = 300,
dev.args=list(bg="white")
)
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d()
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(options = "A")
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "A")
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "B")
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C")
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(text = element_text(family = "chiller"))
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
font = element_text(family = "chiller"),
title = element_text(family = "chiller"),
subtitle = element_text(family = "chiller"),
strip.text = element_text(family = "chiller"),
strip.text.x = element_text(family = "chiller"),
caption = element_text(family = "chiller"),
)
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "chiller"),
title = element_text(family = "chiller"),
subtitle = element_text(family = "chiller"),
strip.text = element_text(family = "chiller"),
strip.text.x = element_text(family = "chiller"),
caption = element_text(family = "chiller"),
)
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "chiller"),
plot.title = element_text(family = "chiller"),
plot.subtitle = element_text(family = "chiller"),
strip.text = element_text(family = "chiller"),
strip.text.x = element_text(family = "chiller"),
caption = element_text(family = "chiller"),
)
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "chiller"),
plot.title = element_text(family = "chiller"),
plot.subtitle = element_text(family = "chiller"),
strip.text = element_text(family = "chiller"),
strip.text.x = element_text(family = "chiller"),
plot.caption = element_text(family = "chiller"),
)
windowsFonts(SetimoLight = windowsFont("chiller"))
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "chiller"),
plot.title = element_text(family = "chiller"),
plot.subtitle = element_text(family = "chiller"),
strip.text = element_text(family = "chiller"),
strip.text.x = element_text(family = "chiller"),
plot.caption = element_text(family = "chiller"),
)
windowsFonts(SetimoLight = windowsFont("chiller"))
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "chiller"),
plot.title = element_text(family = "chiller"),
plot.subtitle = element_text(family = "chiller"),
strip.text = element_text(family = "chiller"),
strip.text.x = element_text(family = "chiller"),
plot.caption = element_text(family = "chiller"),
)
windowsFonts(Chiller = windowsFont("Chiller"))
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "Chiller"),
plot.title = element_text(family = "Chiller"),
plot.subtitle = element_text(family = "Chiller"),
strip.text = element_text(family = "Chiller"),
strip.text.x = element_text(family = "Chiller"),
plot.caption = element_text(family = "Chiller"),
)
ggsave_both("yfir")
df3 <- yfirverd(
SerbyliFjolbyli,
eftir = "tegund h√∫sn√¶√∞is",
filters = quos(
SerbyliFjolbyli != "Anna√∞",
SerbyliFjolbyli != "S√©rh√¶ft √≠b√∫√∞arh√∫sn√¶√∞i")
)
ggsave_both("yfir")
yfirverd_get_data()
df <- yfirverd()
df <- yfirverd()
theme_set_hms()
df <- yfirverd()
# set template
source("https://github.com/karsfri/ILS/raw/master/theme_hms.R")
source("https://github.com/karsfri/ILS/raw/master/demo_automation.R", encoding = "UTF-8")
theme_set_hms()
library(tidyverse)
# √ûannig a√∞ m√°na√∞arn√∂fnin koma r√©tt
Sys.setenv(LANGUAGE="is")
Sys.setlocale("LC_TIME", "Icelandic")
knitr::opts_chunk$set(
echo = TRUE,
fig.width = 18/2.54,
message = FALSE,
warning = FALSE,
include = TRUE,
dpi = 300,
dev.args=list(bg="white")
)
df <- yfirverd()
df_landshluti <- yfirverd(Landshluti)
df3 <- yfirverd(SerbyliFjolbyli, eftir = "tegund h√∫sn√¶√∞is")
yfirverd(print_plot = FALSE, Landshluti)
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2)
windowsFonts(Chiller = windowsFont("Chiller"))
yfirverd(Landshluti, print_plot = FALSE) %>%
plot_yfirverd(title = "√ûetta er titill") +
facet_wrap(~Landshluti, ncol = 2) +
scale_fill_viridis_d(option = "C") +
theme(
text = element_text(family = "Chiller"),
plot.title = element_text(family = "Chiller"),
plot.subtitle = element_text(family = "Chiller"),
strip.text = element_text(family = "Chiller"),
strip.text.x = element_text(family = "Chiller"),
plot.caption = element_text(family = "Chiller"),
)
df3 <- yfirverd(
SerbyliFjolbyli,
eftir = "tegund h√∫sn√¶√∞is",
filters = quos(
SerbyliFjolbyli != "Anna√∞",
SerbyliFjolbyli != "S√©rh√¶ft √≠b√∫√∞arh√∫sn√¶√∞i")
)
ggsave_both("yfir")
yfirverd_get_data()
source('~/GitHub/ILS/demo_automation.R', encoding = 'UTF-8')
df_landshluti <- yfirverd(Landshluti)
df_landshluti <- yfirverd(Landshluti)
plot_yfirverd <- function(df, title = NULL){
df %>%
ggplot(aes(x = timi, y = val, fill = var)) +
geom_area(position = position_fill()) +
scale_y_continuous(labels = scales::percent_format()) +
labs(
y = NULL,
x = NULL,
title = title,
subtitle = "-3ja m√°na√∞a hlaupandi me√∞altal",
caption = "Heimild: √ûj√≥√∞skr√° √çslands, Fasteignaleit, hagdeild HMS"
)
}
yfirverd <- function(..., print_plot = TRUE, eftir = NULL, filters = NULL){
require(tidyverse)
require(lubridate)
require(glue)
df <- yfirverd_get_data()
my_groups <- enquos(...)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
) %>%
select(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi, timi, !!!my_groups) %>%
gather(var, val, SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi) %>%
mutate(
var = var %>%
fct_inorder() %>%
fct_rev %>%
fct_recode(
`Selt undir augl√Ωstu s√∂luver√∞i` = "SeltUndirAuglystuSoluverdi",
`Selt √° augl√Ωstu s√∂luver√∞i` = "SeltAAuglystuSoluverdi",
`Selt yfir augl√Ωstu s√∂luver√∞i` = "SeltYfirAuglystuSoluverdi"
)
) %>%
group_by(var) %>%
mutate(val = (val + lag(val) + lag(val, 2)) / 3)
# Plot
eftir <- if_else(is.null(eftir), "", paste0("eftir ", eftir, " "))
title <- glue("Kaupver√∞ √≠b√∫√∞a {eftir}√≠ samanbur√∞i vi√∞ √°sett ver√∞")
if(print_plot) {
p <- plot_yfirverd(df2, title = title) +
facet_wrap(facets = vars(!!!my_groups))
print(p)
}
return(df2)
}
df_landshluti <- yfirverd(Landshluti)
debugSource('~/GitHub/ILS/demo_automation.R', encoding = 'UTF-8')
df_landshluti <- yfirverd(Landshluti)
require(tidyverse)
require(lubridate)
require(glue)
df <- yfirverd_get_data()
df
my_groups <- enquos(...)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
) %>%
select(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi, timi, !!!my_groups) %>%
gather(var, val, SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi) %>%
mutate(
var = var %>%
fct_inorder() %>%
fct_rev %>%
fct_recode(
`Selt undir augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltUndirAuglystuSoluverdi",
`Selt √É¬° augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltAAuglystuSoluverdi",
`Selt yfir augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltYfirAuglystuSoluverdi"
)
)
source("https://github.com/karsfri/ILS/raw/master/demo_automation.R", encoding = "UTF-8")
df_landshluti <- yfirverd(Landshluti)
df_landshluti <- yfirverd(Landshluti)
debugSource('~/GitHub/ILS/demo_automation.R', encoding = 'UTF-8')
df_landshluti <- yfirverd(Landshluti)
require(tidyverse)
require(lubridate)
require(glue)
df <- yfirverd_get_data()
my_groups <- enquos(...)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
) %>%
select(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi, timi, !!!my_groups) %>%
gather(var, val, SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi) %>%
mutate(
var = var %>%
fct_inorder() %>%
fct_rev %>%
fct_recode(
`Selt undir augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltUndirAuglystuSoluverdi",
`Selt √É¬° augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltAAuglystuSoluverdi",
`Selt yfir augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltYfirAuglystuSoluverdi"
)
) %>%
group_by(var) %>%
mutate(val = (val + lag(val) + lag(val, 2)) / 3)
df2
df2 %>% names()
# Plot
eftir <- if_else(is.null(eftir), "", paste0("eftir ", eftir, " "))
title <- glue("Kaupver√∞ √≠b√∫√∞a {eftir}√≠ samanbur√∞i vi√∞ √°sett ver√∞")
if(print_plot) {
p <- plot_yfirverd(df2, title = title) +
facet_wrap(facets = vars(!!!my_groups))
print(p)
}
plot_yfirverd(df2, title = title) +
facet_wrap(facets = vars(!!!my_groups))
my_groups
plot_yfirverd(df2, title = title)
df_landshluti <- yfirverd(Landshluti)
require(tidyverse)
require(lubridate)
require(glue)
df <- yfirverd_get_data()
my_groups <- enquos(...)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
) %>%
select(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi, timi, !!!my_groups) %>%
gather(var, val, SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi) %>%
mutate(
var = var %>%
fct_inorder() %>%
fct_rev %>%
fct_recode(
`Selt undir augl√Ωstu s√∂luver√∞i` = "SeltUndirAuglystuSoluverdi",
`Selt √° augl√Ωstu s√∂luver√∞i` = "SeltAAuglystuSoluverdi",
`Selt yfir augl√Ωstu s√∂luver√∞i` = "SeltYfirAuglystuSoluverdi"
)
) %>%
group_by(var) %>%
mutate(val = (val + lag(val) + lag(val, 2)) / 3)
# Plot
eftir <- if_else(is.null(eftir), "", paste0("eftir ", eftir, " "))
title <- glue("Kaupver√∞ √≠b√∫√∞a {eftir}√≠ samanbur√∞i vi√∞ √°sett ver√∞")
if(print_plot) {
p <- plot_yfirverd(df2, title = title) +
facet_wrap(facets = vars(!!!my_groups))
print(p)
}
df_landshluti <- yfirverd(Landshluti)
require(tidyverse)
require(lubridate)
require(glue)
df <- yfirverd_get_data()
my_groups <- enquos(...)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
) %>%
select(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi, timi, !!!my_groups) %>%
gather(var, val, SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi) %>%
mutate(
var = var %>%
fct_inorder() %>%
fct_rev %>%
fct_recode(
`Selt undir augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltUndirAuglystuSoluverdi",
`Selt √É¬° augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltAAuglystuSoluverdi",
`Selt yfir augl√É¬Ωstu s√É¬∂luver√É¬∞i` = "SeltYfirAuglystuSoluverdi"
)
) %>%
group_by(var) %>%
mutate(val = (val + lag(val) + lag(val, 2)) / 3)
# Plot
eftir <- if_else(is.null(eftir), "", paste0("eftir ", eftir, " "))
title <- glue("Kaupver√É¬∞ √É≠b√É¬∫√É¬∞a {eftir}√É≠ samanbur√É¬∞i vi√É¬∞ √É¬°sett ver√É¬∞")
plot_yfirverd(df2, title = title)
p <- plot_yfirverd(df2, title = title) +
facet_wrap(facets = vars(!!!my_groups))
print(p)
p
plot_yfirverd(df2, title = title)
plot_yfirverd(df2, title = title) %>% print
p <- plot_yfirverd(df2, title = title)
print(p)
my_groups
plot_yfirverd
df_landshluti <- yfirverd(Landshluti)
df_landshluti <- yfirverd(Landshluti)
debugSource('~/GitHub/ILS/demo_automation.R', encoding = 'UTF-8')
df_landshluti <- yfirverd(Landshluti)
eftir
title
plot_yfirverd(df2, title = title)
plot_yfirverd(df2, title = title) %>% print
p <- plot_yfirverd(df2, title = title)
my_groups
df <- yfirverd_get_data()
my_groups <- enquos(...)
df2 <- df %>%
sql_clean() %>%
# map(filters, ~. %>% filter(!!!.x))
filter(!!!filters) %>%
mutate(timi = floor_date(Dim_Timi_Utgefid, unit = "months")) %>%
group_by(timi, !!!my_groups) %>%
summarise_at(
vars(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi),
sum,
na.rm = TRUE
) %>%
select(SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi, timi, !!!my_groups) %>%
gather(var, val, SeltYfirAuglystuSoluverdi, SeltAAuglystuSoluverdi, SeltUndirAuglystuSoluverdi) %>%
mutate(
var = var %>%
fct_inorder() %>%
fct_rev %>%
fct_recode(
`Selt undir augl√Ωstu s√∂luver√∞i` = "SeltUndirAuglystuSoluverdi",
`Selt √° augl√Ωstu s√∂luver√∞i` = "SeltAAuglystuSoluverdi",
`Selt yfir augl√Ωstu s√∂luver√∞i` = "SeltYfirAuglystuSoluverdi"
)
) %>%
group_by(var) %>%
mutate(val = (val + lag(val) + lag(val, 2)) / 3)
# Plot
eftir <- if_else(is.null(eftir), "", paste0("eftir ", eftir, " "))
title <- glue("Kaupver√∞ √≠b√∫√∞a {eftir}√≠ samanbur√∞i vi√∞ √°sett ver√∞")
plot_yfirverd(df2, title = title)
plot_yfirverd(df2, title = title) +
facet_wrap(facets = vars(!!!my_groups))
plot_yfirverd(df2, title = title) %>% class()
ggplot2::df2
df2
plot_yfirverd(df2, title = title)
library(HMSr)
theme_hms()
library(HMSr)
theme_hms()
library(HMSr)
theme_hms()
library(HMSr)
theme_hms()
ggplot2::theme_gray()
library(HMSr)
theme_hms()
library(HMSr)
theme_hms()
?theme_hms
library(HMSr)
theme_hms()
?theme_hms
library(HMSr)
theme_hms()
?theme_hms
library(HMSr)
theme_hms()
?theme_hms
library(HMSr)
theme_hms()
?theme_hms
library(HMSr)
theme_hms()
?theme_hms
library(HMSr)
theme_hms()
?theme_hms
